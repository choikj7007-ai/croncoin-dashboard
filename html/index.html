<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CronCoin Dashboard</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- Header & Tabs -->
<div class="header">
    <div class="logo">CronCoin <span>Dashboard</span> <span class="chain-badge" id="chain-badge"></span></div>
    <div class="tabs">
        <button class="tab active" data-tab="blocks" data-i18n="tab.blocks">Block Explorer</button>
        <button class="tab" data-tab="transactions" data-i18n="tab.transactions">Transactions</button>
        <button class="tab" data-tab="wallet" data-i18n="tab.wallet">Create Wallet</button>
        <button class="tab" data-tab="send" data-i18n="tab.send">Send Coin</button>
        <button class="tab" data-tab="mining" data-i18n="tab.mining">Mining</button>
        <button class="tab" data-tab="richlist" data-i18n="tab.richlist">Rich List</button>
        <button class="tab" data-tab="network" data-i18n="tab.network">Network</button>
        <button class="tab" data-tab="dice" data-i18n="tab.dice">Dice</button>
        <button class="tab" data-tab="guide" data-i18n="tab.guide">Guide</button>
    </div>
    <button class="lang-btn" id="lang-btn" title="Switch language">EN | 한</button>
</div>

<!-- Main Content -->
<div class="main">
    <div id="global-notice" class="notice notice-warning" style="display:none;max-width:1200px;margin:0 auto 16px"></div>

    <!-- 1. Block Explorer -->
    <div class="tab-content active" id="tab-blocks">
        <div class="search-bar">
            <input type="text" id="block-search" data-i18n-placeholder="block.searchPlaceholder" placeholder="Search by block hash or height...">
            <button class="btn btn-primary" id="block-search-btn" data-i18n="search">Search</button>
        </div>

        <!-- Block Detail (hidden by default) -->
        <div id="block-detail" class="card" style="display:none">
            <div class="card-title" data-i18n="block.detail">Block Detail</div>
            <div class="info-grid" id="block-detail-info"></div>
            <div id="block-metadata"></div>
            <div style="margin-top:16px">
                <div class="card-title" data-i18n="block.transactions">Transactions</div>
                <div class="table-wrap">
                    <table>
                        <thead><tr>
                            <th data-i18n="th.txid">TxID</th>
                            <th data-i18n="th.size">Size</th>
                            <th data-i18n="th.inputs">Inputs</th>
                            <th data-i18n="th.outputs">Outputs</th>
                        </tr></thead>
                        <tbody id="block-tx-list"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Recent Blocks -->
        <div class="card">
            <div class="card-title" data-i18n="block.recentBlocks">Recent Blocks</div>
            <div id="recent-blocks" class="block-list">
                <div class="loading" data-i18n="loading">Loading...</div>
            </div>
        </div>
    </div>

    <!-- 2. Transaction Explorer -->
    <div class="tab-content" id="tab-transactions">
        <div class="search-bar">
            <input type="text" id="tx-search" data-i18n-placeholder="tx.searchPlaceholder" placeholder="Search by transaction ID...">
            <button class="btn btn-primary" id="tx-search-btn" data-i18n="search">Search</button>
        </div>

        <div id="tx-detail" class="card" style="display:none">
            <div class="card-title" data-i18n="tx.detail">Transaction Detail</div>
            <div class="info-grid" id="tx-detail-info"></div>
            <div id="tx-metadata"></div>

            <div style="margin-top:16px">
                <div class="card-title" data-i18n="tx.inputs">Inputs</div>
                <div class="table-wrap">
                    <table>
                        <thead><tr>
                            <th data-i18n="th.txid">TxID</th>
                            <th data-i18n="th.vout">Vout</th>
                            <th data-i18n="th.scriptSig">ScriptSig / Witness</th>
                        </tr></thead>
                        <tbody id="tx-inputs"></tbody>
                    </table>
                </div>
            </div>

            <div style="margin-top:16px">
                <div class="card-title" data-i18n="tx.outputs">Outputs</div>
                <div class="table-wrap">
                    <table>
                        <thead><tr>
                            <th data-i18n="th.index">#</th>
                            <th data-i18n="th.amount">Amount (CRN)</th>
                            <th data-i18n="th.addressScript">Address / Script</th>
                        </tr></thead>
                        <tbody id="tx-outputs"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title" data-i18n="wallet.recentTx">Recent Transactions</div>
            <div class="table-wrap">
                <table>
                    <thead><tr>
                        <th data-i18n="th.txid">TxID</th>
                        <th data-i18n="th.category">Category</th>
                        <th data-i18n="th.amount">Amount</th>
                        <th data-i18n="th.confirmations">Confirmations</th>
                        <th data-i18n="th.time">Time</th>
                    </tr></thead>
                    <tbody id="wallet-tx-list"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 3. Wallet (HD Key Generation Flow) -->
    <div class="tab-content" id="tab-wallet">
        <div class="card">
            <div class="card-title" data-i18n="wallet.newAddress">Coin Wallet</div>
            <div class="guide-notice" id="wallet-guide-notice"></div>
            <div class="address-guide-actions" id="wallet-generate-actions">
                <button class="btn btn-warning" id="hd-generate-btn" data-i18n="hd.generateBtn">Generate New Wallet</button>
            </div>
        </div>

        <!-- HD Flow Steps (progressively revealed) -->
        <div id="hd-flow-container" style="display:none">
            <!-- Step 1: Mnemonic -->
            <div class="card hd-step" id="hd-step-mnemonic">
                <div class="hd-step-header">
                    <span class="hd-step-num">1</span>
                    <span class="hd-step-title" data-i18n="hd.step2">Seed 12 Words (Mnemonic)</span>
                    <span class="hd-step-warning" data-i18n="hd.mnemonicWarning">VERY IMPORTANT : Write on paper and store in a safe place</span>
                    <span class="hd-step-arrow">&darr;</span>
                </div>
                <div class="hd-step-desc" data-i18n="hd.step2Desc">12 words derived from entropy + checksum (BIP39)</div>
                <div class="hd-step-value" id="hd-mnemonic"></div>
            </div>
            <!-- Step 2: Master Key -->
            <div class="card hd-step" id="hd-step-master">
                <div class="hd-step-header">
                    <span class="hd-step-num">2</span>
                    <span class="hd-step-title" data-i18n="hd.step3">Master Key</span>
                    <span class="hd-step-arrow">&darr;</span>
                </div>
                <div class="hd-step-desc" data-i18n="hd.step3Desc">Mnemonic + HMAC-SHA512 → two keys generated simultaneously</div>
                <div id="hd-master-keys"></div>
            </div>
            <!-- Step 3: Private Key -->
            <div class="card hd-step" id="hd-step-privkey">
                <div class="hd-step-header">
                    <span class="hd-step-num">3</span>
                    <span class="hd-step-title" data-i18n="hd.step5">Private Key</span>
                    <span class="hd-step-arrow">&darr;</span>
                </div>
                <div class="hd-step-desc" data-i18n="hd.step5Desc">WIF private key extracted from the final child xprv</div>
                <div class="hd-step-value mono-text privkey-text" id="hd-privkey"></div>
            </div>
            <!-- Step 4: Public Key -->
            <div class="card hd-step" id="hd-step-pubkey">
                <div class="hd-step-header">
                    <span class="hd-step-num">4</span>
                    <span class="hd-step-title" data-i18n="hd.step6">Public Key</span>
                    <span class="hd-step-arrow">&darr;</span>
                </div>
                <div class="hd-step-desc" data-i18n="hd.step6Desc">Compressed public key from secp256k1 elliptic curve multiplication</div>
                <div class="hd-step-value mono-text" id="hd-pubkey"></div>
            </div>
            <!-- Step 5: Address -->
            <div class="card hd-step" id="hd-step-address">
                <div class="hd-step-header">
                    <span class="hd-step-num">5</span>
                    <span class="hd-step-title" data-i18n="hd.step7">Address</span>
                    <span class="hd-step-warning" data-i18n="hd.addressNotice">To receive coins, share this address</span>
                </div>
                <div class="hd-step-desc" data-i18n="hd.step7Desc">Public Key → SHA-256 → RIPEMD-160 → Bech32 encoding</div>
                <div class="address-with-qr">
                    <div class="hd-step-value address-display" id="hd-address"></div>
                    <div class="address-qr" id="hd-address-qr"></div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="hd-action-bar" id="hd-action-bar" style="display:none">
                <button class="btn btn-action" id="hd-copy-btn" data-i18n="hd.copyBtn">Copy</button>
                <button class="btn btn-action" id="hd-save-btn" data-i18n="hd.saveBtn">Save as File</button>
            </div>
        </div>

        <!-- Warning notice after generation -->
        <div class="card" id="hd-backup-warning" style="display:none">
            <div class="guide-notice seed-warning" id="hd-backup-notice"></div>
        </div>
    </div>

    <!-- 3-2. Send Coin -->
    <div class="tab-content" id="tab-send">
        <div class="card">
            <div class="card-title" data-i18n="send.title">Send CRN</div>
            <div class="form-row">
                <div class="form-group">
                    <label data-i18n="send.recipientAddress">Recipient Address</label>
                    <input type="text" id="send-address" data-i18n-placeholder="send.addressPlaceholder" placeholder="croncoin address...">
                </div>
                <div class="form-group">
                    <label data-i18n="send.amount">Amount (CRN)</label>
                    <input type="number" id="send-amount" step="0.001" min="0.001" placeholder="0.000">
                </div>
            </div>
            <button class="btn btn-primary" id="send-btn" data-i18n="send.sendBtn">Send</button>
            <div id="send-result"></div>
        </div>
    </div>

    <!-- 4. Mining -->
    <div class="tab-content" id="tab-mining">
        <div class="card">
            <div class="balance-display">
                <div class="balance-label" data-i18n="mining.miningBalance">Mining Balance</div>
                <div class="balance-amount" id="mining-balance">—</div>
            </div>
            <div class="info-grid" id="mining-balance-grid"></div>
        </div>

        <div class="card">
            <div class="card-title" data-i18n="mining.info">Mining Info</div>
            <div class="info-grid" id="mining-info-grid"></div>
        </div>

        <div class="card">
            <div class="card-title" data-i18n="mining.generateBlocks">Generate Blocks</div>
            <div class="form-row">
                <div class="form-group">
                    <label data-i18n="mining.numBlocks">Number of Blocks</label>
                    <input type="number" id="mine-count" value="1" min="1" max="1000">
                </div>
                <div class="form-group">
                    <label data-i18n="mining.addressLabel">Address (leave empty for wallet default)</label>
                    <input type="text" id="mine-address" data-i18n-placeholder="mining.addressPlaceholder" placeholder="optional address...">
                </div>
            </div>
            <button class="btn btn-primary" id="mine-btn" data-i18n="mining.mineBtn">Mine Blocks</button>
            <div id="mine-result" class="mine-result"></div>
        </div>
    </div>

    <!-- 5. Rich List -->
    <div class="tab-content" id="tab-richlist">
        <div class="card">
            <div class="card-title" data-i18n="richlist.title">Top Addresses by Balance</div>
            <div class="info-grid" id="richlist-summary"></div>
        </div>
        <div class="card">
            <div class="table-wrap">
                <table>
                    <thead><tr>
                        <th data-i18n="richlist.rank">#</th>
                        <th data-i18n="th.address">Address</th>
                        <th data-i18n="richlist.balance">Balance (CRN)</th>
                        <th data-i18n="richlist.percent">% of Supply</th>
                    </tr></thead>
                    <tbody id="richlist-table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 6. Network Status -->
    <div class="tab-content" id="tab-network">
        <div class="card">
            <div class="card-title" data-i18n="network.blockchain">Blockchain</div>
            <div class="info-grid" id="chain-info-grid"></div>
        </div>

        <div class="card">
            <div class="card-title" data-i18n="network.network">Network</div>
            <div class="info-grid" id="net-info-grid"></div>
        </div>

        <div class="card">
            <div class="card-title" data-i18n="network.mempool">Mempool</div>
            <div class="info-grid" id="mempool-info-grid"></div>
        </div>

        <div class="card">
            <div class="card-title" data-i18n="network.peers">Connected Peers</div>
            <div class="table-wrap">
                <table>
                    <thead><tr>
                        <th data-i18n="th.address">Address</th>
                        <th data-i18n="th.subversion">Subversion</th>
                        <th data-i18n="th.ping">Ping (ms)</th>
                        <th data-i18n="th.sent">Sent</th>
                        <th data-i18n="th.received">Received</th>
                    </tr></thead>
                    <tbody id="peer-table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 7. Dice -->
    <div class="tab-content" id="tab-dice">
        <div class="card">
            <div class="card-title" id="dice-next-title">Next Block Dice</div>
            <div class="dice-hero" id="dice-hero">
                <div class="dice-face" id="dice-face" data-value="?">
                    <div class="dice-question">?</div>
                </div>
                <div class="dice-countdown" id="dice-countdown"></div>
                <div class="dice-hero-info" id="dice-hero-info"></div>
            </div>
        </div>

        <div class="card">
            <div class="card-title" data-i18n="dice.history">Block Dice History</div>
            <div class="table-wrap">
                <table>
                    <thead><tr>
                        <th data-i18n="dice.block">Block</th>
                        <th data-i18n="dice.value">Dice</th>
                        <th data-i18n="dice.oddEven">Odd/Even</th>
                        <th data-i18n="dice.time">Time</th>
                        <th data-i18n="dice.hash">Block Hash</th>
                    </tr></thead>
                    <tbody id="dice-table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 8. Guide -->
    <div class="tab-content" id="tab-guide">
        <div class="card">
            <div class="card-title" data-i18n="guide.title">Dashboard Guide</div>
            <div class="guide-content" id="guide-content"></div>
        </div>
    </div>

</div>

<!-- Status Bar -->
<div class="status-bar">
    <div class="status-item">
        <div class="status-dot" id="status-dot"></div>
        <span id="status-chain">—</span>
    </div>
    <div class="status-item"><span data-i18n="status.height">Height</span>: <span id="status-height">—</span></div>
    <div class="status-item"><span data-i18n="status.connections">Connections</span>: <span id="status-connections">—</span></div>
    <div class="status-item"><span data-i18n="status.mempool">Mempool</span>: <span id="status-mempool">—</span></div>
    <div class="status-item"><span data-i18n="status.supply">Supply</span>: <span id="status-supply">—</span></div>
</div>

<!-- Toast -->
<div id="toast" class="toast"></div>

<script src="js/qrcode.min.js"></script>
<script src="js/i18n.js"></script>
<script src="js/utils.js"></script>
<script src="js/app.js"></script>
</body>
</html>
